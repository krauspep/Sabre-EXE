CREATE GENERATOR EMPLOYEE_CARD_GEN;

CREATE TABLE EMPLOYEE_CARD
(
  EMPLOYEE_CARD_KEY DM_KEY,
  COMPANY_KEY DM_KEY,
  GENERIC_KEY DM_KEY,
  RESIDENT DM_BOOLEAN,
  CARD_NUMBER DM_VARCHAR_20,
  ACTIVE_RECORD DM_ACTIVE DEFAULT 1,
  DELETED DM_BOOLEAN  DEFAULT 0,
  PRIMARY KEY (EMPLOYEE_CARD_KEY)
);

GRANT DELETE, INSERT, REFERENCES, SELECT, UPDATE ON EMPLOYEE_CARD TO SYSDBA WITH GRANT OPTION;

CREATE TRIGGER TR_EMPLOYEE_CARD FOR EMPLOYEE_CARD ACTIVE BEFORE INSERT POSITION 0
AS
begin
  if (new.EMPLOYEE_CARD_KEY is null)
  then begin
         new.EMPLOYEE_CARD_KEY = gen_id(EMPLOYEE_CARD_GEN, 1);
       end
end
