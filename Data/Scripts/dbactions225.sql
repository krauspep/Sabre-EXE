CREATE GENERATOR PAYROLL_DAY_DATE_GEN;

CREATE TABLE PAYROLL_DAY_DATE
(
  PAYROLL_DAY_DATE_KEY DM_KEY NOT NULL,
  FINANCIAL_MONTH DM_SMALLINT,
  FINANCIAL_YEAR DM_SMALLINT,
  DATE_DAY DM_DATE,
  DELETED DM_BOOLEAN DEFAULT 0,
  DATE_YEAR DM_SMALLINT,
  COMPANY_KEY DM_KEY,
  ACTIVE_RECORD DM_ACTIVE DEFAULT 1,
  PRIMARY KEY (PAYROLL_DAY_DATE_KEY)
);

CREATE INDEX I_PAYROLL_DAY_DATE_1 ON PAYROLL_DAY_DATE (FINANCIAL_MONTH,FINANCIAL_YEAR,DELETED);

GRANT DELETE, INSERT, REFERENCES, SELECT, UPDATE ON PAYROLL_DAY_DATE TO SYSDBA WITH GRANT OPTION;

CREATE TRIGGER TR_PAYROLL_DAY_DATE FOR PAYROLL_DAY_DATE ACTIVE BEFORE INSERT POSITION 0
AS
begin
  if (new.PAYROLL_DAY_DATE_KEY is null)
  then begin
         new.PAYROLL_DAY_DATE_KEY = gen_id(PAYROLL_DAY_DATE_GEN, 1);
       end
end





