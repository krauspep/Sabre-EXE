CREATE DOMAIN DM_INTEGER_0 AS INTEGER DEFAULT 0;

ALTER TABLE EMPLOYEE_ATTENDANCE_DATA ADD MINUTES_UNAPPROVED_OT1 DM_INTEGER;

UPDATE EMPLOYEE_ATTENDANCE_DATA SET MINUTES_UNAPPROVED_OT1 = 0;

ALTER TABLE EMPLOYEE_ATTENDANCE_DATA ADD OT1_MINUTES_SPLIT DM_BOOLEAN;

UPDATE EMPLOYEE_ATTENDANCE_DATA SET OT1_MINUTES_SPLIT = 0;

ALTER TABLE EMPLOYEE_ATTENDANCE_DATA ADD UNAPPROVE_REASON_KEY DM_KEY_N1;

UPDATE EMPLOYEE_ATTENDANCE_DATA SET UNAPPROVE_REASON_KEY = -1;

CREATE GENERATOR UNAPPROVE_REASON_GEN;

CREATE TABLE UNAPPROVE_REASON
(
  UNAPPROVE_REASON_KEY DM_KEY,
  UNAPPROVE_REASON DM_NAME,
  COMPANY_KEY DM_KEY_N1, 
  DELETED DM_BOOLEAN DEFAULT 0,
  ACTIVE_RECORD DM_ACTIVE DEFAULT 1,
  PRIMARY KEY (UNAPPROVE_REASON_KEY)
);

GRANT DELETE, INSERT, REFERENCES, SELECT, UPDATE ON UNAPPROVE_REASON TO  "SYSDBA" WITH GRANT OPTION;

CREATE TRIGGER TR_UNAPPROVE_REASON FOR UNAPPROVE_REASON
ACTIVE BEFORE INSERT POSITION 0
AS
begin
  if (new.UNAPPROVE_REASON_KEY is null)
  then begin
         new.UNAPPROVE_REASON_KEY = gen_id(UNAPPROVE_REASON_GEN, 1);
       end
end