From:	Bernd [berndvf@gmail.com]
Sent:	08 October 2013 08:58 PM
To:	Noel Harper
Subject:	Re: FW: Help with a fix SQL

SET TERM ^;
EXECUTE BLOCK
AS
    DECLARE L_START_DATE        DATE        = '2012.01.01';
    DECLARE L_END_DATE          DATE        = '2012.12.31';
BEGIN   
    -- Update the Attendance Records
    UPDATE ATTENDANCE A
       SET A.EVENT_KEY = CASE ATTENDANCE.EVENT_KEY WHEN 6 THEN 2 WHEN 5 
THEN 1 ELSE ATTENDANCE.EVENT_KEY END
     WHERE A.ATTENDANCE_DATE BETWEEN :L_START_DATE AND :L_END_DATE
       AND A.EVENT_KEY IN ( 5, 6 )
       AND A.RECORD_STATUS IN ('DI','OA');
END^
SET TERM;^


On Mon, Oct 7, 2013 at 11:24 AM, Noel Harper <noel.sabre@gmail.com> wrote:
Hi bernd Sorry ignore 1st e mail made a mistake and thanks for doing this for me..
It works only for one change in or out so must have 6 and 2 and then 5 and 1 and it works.
How do I combine the two together and also make it do the same for OA also.
Also if I want to save it as a SQL form a txt do i just put : at the end of command.
Thanks
Noel
 
From: Bernd [mailto:berndvf@gmail.com] 
Sent: 07 October 2013 07:41 AM 
To: Noel Harper
Subject: Re: FW: Help with a fix SQL
 
SET TERM ^;
EXECUTE BLOCK
AS
    DECLARE L_START_DATE        DATE        = '2012.01.01';
    DECLARE L_END_DATE          DATE        = '2012.12.31';
    DECLARE L_FROM_EVENT         INT         = 6;
    DECLARE L_TO_EVENT           INT         = 2;
    
BEGIN   
    -- Update the Attendance Records
    UPDATE ATTENDANCE A
       SET A.EVENT_KEY = :L_TO_EVENT
     WHERE A.ATTENDANCE_DATE BETWEEN :L_START_DATE AND :L_END_DATE
       AND A.EVENT_KEY = :L_FROM_EVENT
       AND A.RECORD_STATUS = 'DI';
END^
SET TERM;^
 
/*
1          IN
2          OUT
3          Access IN
4          Access OUT
5          Break IN
6          Break OUT
*/
 
 
On Sat, Oct 5, 2013 at 6:29 PM, Noel Harper <noel.sabre@gmail.com> wrote:
Hi bernd Found this one but not sure how to change it to below settings.
SET TERM ^;
EXECUTE BLOCK
AS
    DECLARE L_START_DATE        DATE        = '2012.01.01';
    DECLARE L_END_DATE          DATE        = '2012.12.31';
    DECLARE L_NEW_EVENT         INT         = 7;
    DECLARE L_RECORD_STATUS     VARCHAR(10) = 'DI';
BEGIN    
    -- Update the Attendance Records
    UPDATE ATTENDANCE A
       SET A.EVENT_KEY = :L_NEW_EVENT
     WHERE A.ATTENDANCE_DATE BETWEEN :L_START_DATE AND :L_END_DATE
       AND A.RECORD_STATUS = :L_RECORD_STATUS;
END^
SET TERM;^
To do the following “change event Break in (2 to 0 ) and clocking to in and breakout (3 to 1 )to out in 
Attendance table for a specific date period.”
Thanks
Noel
 
From: Noel Harper [mailto:noel.sabre@gmail.com]  
Sent: 05 October 2013 06:17 PM 
To: 'berndvf@gmail.com' 
Subject: Help with a fix SQL
 
Hi Bernd
Please can you help me with a fix SQL to change event Break in clocking to in and breakout to out in 
Attendance table for a specific date period.
Thanks
regards
 
 
 
 
 
 
 

