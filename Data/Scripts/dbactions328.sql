CREATE DOMAIN DM_AUDIT AS VARCHAR(512);

CREATE GENERATOR ATTENDANCE_AUDIT_GEN;

CREATE TABLE ATTENDANCE_AUDIT
(
  ATTENDANCE_AUDIT_KEY DM_KEY,
  ATTENDANCE_KEY DM_KEY,
  CHANGES_MADE DM_AUDIT,
  MODIFIED_ON DM_DATE,
  MODIFIED_BY DM_KEY,
  PRIMARY KEY (ATTENDANCE_AUDIT_KEY)
);


GRANT DELETE, INSERT, REFERENCES, SELECT, UPDATE ON ATTENDANCE_AUDIT TO SYSDBA WITH GRANT OPTION;

CREATE TRIGGER TR_ATTENDANCE_AUDIT FOR ATTENDANCE_AUDIT ACTIVE BEFORE INSERT POSITION 0
AS
begin
  if (new.ATTENDANCE_AUDIT_KEY is null)
  then begin
         new.ATTENDANCE_AUDIT_KEY = gen_id(ATTENDANCE_AUDIT_GEN, 1);
       end
end

CREATE INDEX I_ATTENDANCE_AUDIT_1 ON ATTENDANCE_AUDIT (ATTENDANCE_AUDIT_KEY, MODIFIED_BY);
