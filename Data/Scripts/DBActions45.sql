ALTER TABLE COMPANY
ADD USE_PAYROLL DM_SMALLINT;
COMMIT;

CREATE TABLE DATA_GATHERING_METHOD (
  DATA_GATHERING_METHOD_KEY            DM_KEY,
  DATA_GATHERING_METHOD                DM_NAME,
  DELETED                              DM_BOOLEAN
);

COMMIT;

INSERT INTO DATA_GATHERING_METHOD(DATA_GATHERING_METHOD_KEY, DATA_GATHERING_METHOD, DELETED)
VALUES(1, 'Attendance Register Book', 0);
commit;

INSERT INTO DATA_GATHERING_METHOD(DATA_GATHERING_METHOD_KEY, DATA_GATHERING_METHOD, DELETED)
VALUES(2, 'iGuard Clock Card Device', 0);
commit;

INSERT INTO DATA_GATHERING_METHOD(DATA_GATHERING_METHOD_KEY, DATA_GATHERING_METHOD, DELETED)
VALUES(3, 'F4 Clock Card Device', 0);
commit;


CREATE DOMAIN "DM_SMALLINT_0" AS SMALLINT
    DEFAULT 0
    NOT NULL

ALTER TABLE COMPANY
ADD DATA_GATHERING_METHOD DM_SMALLINT_0;
COMMIT;


CREATE GENERATOR BOOK_CONFIGURATION_GEN;
COMMIT;

CREATE TABLE BOOK_CONFIGURATION
(
BOOK_CONFIGURATION_KEY       DM_KEY,
COMPANY_KEY                  DM_KEY,
TERMINAL_KEY                 DM_KEY,
DEVICE_LOCATION_KEY          DM_KEY,
DEPARTMENT_KEY               DM_KEY,
DEVICE_DESCRIPTION           DM_BLOB2,
DELETED                      DM_BOOLEAN,
PRIMARY KEY (BOOK_CONFIGURATION_KEY)
);


SET TERM ^ ;
CREATE TRIGGER TR_BOOK_CONFIGURATION FOR BOOK_CONFIGURATION
ACTIVE BEFORE INSERT POSITION 0
AS
begin
  if (new.BOOK_CONFIGURATION_KEY is null)
  then begin
         new.BOOK_CONFIGURATION_KEY = gen_id(BOOK_CONFIGURATION_GEN, 1);
       end
end
^
SET TERM ; ^

COMMIT;

ALTER TABLE ATTENDANCE
ADD OPERATOR_KEY        DM_INTEGER;
COMMIT;


