CREATE GENERATOR INDIVIDUAL_DEVICE_LINK_GEN;

CREATE TABLE INDIVIDUAL_DEVICE_LINK
(
  INDIVIDUAL_DEVICE_LINK_KEY DM_KEY,
  INDIVIDUAL_KEY DM_KEY,
  DEVICE_KEY DM_KEY,
  ENABLED_ON_DEVICE DM_BOOLEAN DEFAULT 0,
  DELETED DM_BOOLEAN DEFAULT 0,
  OPEN_DOOR DM_BOOLEAN DEFAULT 0,
  DEVICE_TYPE_KEY DM_KEY,
  IS_SELECTED DM_FALSE DEFAULT 'F',
  ENROLL_GROUP DM_SMALLINT,
  ACTIVE_RECORD DM_ACTIVE DEFAULT 1,
  PRIMARY KEY (INDIVIDUAL_DEVICE_LINK_KEY)
);

CREATE INDEX I_INDIVIDUAL_DEVICE_LINK_1 ON INDIVIDUAL_DEVICE_LINK (INDIVIDUAL_KEY, ACTIVE_RECORD, DELETED);

GRANT DELETE, INSERT, REFERENCES, SELECT, UPDATE ON INDIVIDUAL_DEVICE_LINK TO  "SYSDBA" WITH GRANT OPTION;

CREATE TRIGGER TR_INDIVIDUAL_DEVICE_LINK FOR INDIVIDUAL_DEVICE_LINK
ACTIVE BEFORE INSERT POSITION 0
AS
begin
  if (new.INDIVIDUAL_DEVICE_LINK_KEY is null)
  then begin
         new.INDIVIDUAL_DEVICE_LINK_KEY = gen_id(INDIVIDUAL_DEVICE_LINK_GEN, 1);
       end
end
