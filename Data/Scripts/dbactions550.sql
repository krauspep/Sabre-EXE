CREATE GENERATOR SHIFT_FLEXI_TIME_GEN;

CREATE TABLE SHIFT_FLEXI_TIME
(
  SHIFT_FLEXI_TIME_KEY DM_KEY,
  SHIFT_KEY DM_KEY NOT NULL,
  START_TIME DM_TIME,
  DELETED DM_BOOLEAN DEFAULT 0,
  ACTIVE_RECORD DM_ACTIVE DEFAULT 1,
  PRIMARY KEY (SHIFT_KEY,START_TIME)
);

GRANT DELETE, INSERT, REFERENCES, SELECT, UPDATE
 ON SHIFT_FLEXI_TIME TO  SYSDBA WITH GRANT OPTION;

CREATE INDEX I_SHIFT_FLEXI_TIME ON SHIFT_FLEXI_TIME (SHIFT_KEY,START_TIME,DELETED);

CREATE TRIGGER TR_SHIFT_FLEXI_TIME FOR SHIFT_FLEXI_TIME
ACTIVE BEFORE INSERT POSITION 0
AS
begin
  if (new.SHIFT_FLEXI_TIME_KEY is null)
  then begin
     new.SHIFT_FLEXI_TIME_KEY = gen_id(SHIFT_FLEXI_TIME_GEN, 1);
  end
  new.DELETED = 0;
  new.ACTIVE_RECORD = 1;
end


