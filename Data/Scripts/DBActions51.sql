CREATE GENERATOR EMPLOYEE_ATTENDANCE_NOTE_GEN;
COMMIT;

CREATE TABLE EMPLOYEE_ATTENDANCE_NOTE (
  EMPLOYEE_ATTENDANCE_NOTE_KEY         DM_KEY,
  EMPLOYEE_KEY                         DM_KEY,
  ATTENDANCE_DATE_IN                   DM_DATE,
  ATTENDANCE_NOTE                      DM_BLOB,
  DELETED                              DM_BOOLEAN
);

ALTER TABLE EMPLOYEE_ATTENDANCE_NOTE ADD PRIMARY KEY (EMPLOYEE_ATTENDANCE_NOTE_KEY);

SET TERM ^ ;
CREATE TRIGGER TR_EMPLOYEE_ATTENDANCE_NOTE FOR EMPLOYEE_ATTENDANCE_NOTE
ACTIVE BEFORE INSERT POSITION 0
AS
begin
  if (new.EMPLOYEE_ATTENDANCE_NOTE_KEY is null)
  then begin
         new.EMPLOYEE_ATTENDANCE_NOTE_KEY = gen_id(EMPLOYEE_ATTENDANCE_NOTE_GEN, 1);
       end
end
^
SET TERM ; ^

COMMIT;

CREATE INDEX I_EMPLOYEE_ATTENDANCE_NOTE_1 ON EMPLOYEE_ATTENDANCE_NOTE (EMPLOYEE_KEY, ATTENDANCE_DATE_IN, DELETED);

COMMIT;
