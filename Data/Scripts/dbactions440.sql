CREATE GENERATOR INDIVIDUAL_NOTE_GEN;

CREATE TABLE INDIVIDUAL_NOTE
(
  INDIVIDUAL_NOTE_KEY DM_KEY NOT NULL,
  INDIVIDUAL_KEY DM_KEY,
  INDIVIDUAL_NOTE DM_BLOB,
  DELETED DM_BOOLEAN DEFAULT 0,
  NOTE_TYPE_KEY DM_KEY,
  CREATED_BY DM_KEY,
  CREATED_ON DM_DATE,
  LAST_MODIFIED_BY DM_KEY,
  LAST_MODIFIED_ON DM_DATE,
  ACTIVE_RECORD DM_ACTIVE DEFAULT 1,
  PRIMARY KEY (INDIVIDUAL_NOTE_KEY)
);

CREATE INDEX I_INDIVIDUAL_NOTE_1 ON INDIVIDUAL_NOTE (INDIVIDUAL_KEY,DELETED);

GRANT DELETE, INSERT, REFERENCES, SELECT, UPDATE ON INDIVIDUAL_NOTE TO  "SYSDBA" WITH GRANT OPTION;

CREATE TRIGGER TR_INDIVIDUAL_NOTE FOR INDIVIDUAL_NOTE
ACTIVE BEFORE INSERT POSITION 0
AS
begin
  if (new.INDIVIDUAL_NOTE_KEY is null)
  then begin
         new.INDIVIDUAL_NOTE_KEY = gen_id(INDIVIDUAL_NOTE_GEN, 1);
       end
end
