CREATE GENERATOR BRANCH_GEN;

SET GENERATOR BRANCH_GEN TO 1;

CREATE TABLE BRANCH
(
  BRANCH_KEY DM_KEY NOT NULL,
  BRANCH_NAME DM_NAME,
  DELETED DM_BOOLEAN DEFAULT 0,
  ACTIVE_RECORD DM_ACTIVE DEFAULT 1,
  COMPANY_KEY DM_KEY,
  PRIMARY KEY (BRANCH_KEY)
);

GRANT DELETE, INSERT, REFERENCES, SELECT, UPDATE
 ON BRANCH TO  SYSDBA WITH GRANT OPTION;

CREATE TRIGGER TR_BRANCH FOR BRANCH ACTIVE
BEFORE INSERT POSITION 0
AS
begin
  if (new.BRANCH_KEY is null)
  then begin
         new.BRANCH_KEY = gen_id(BRANCH_GEN, 1);
       end
end

ALTER TABLE EMPLOYEE ADD 
BRANCH_KEY DM_INTEGER;

ALTER TABLE EMPLOYEE ADD 
COST_CENTER_KEY DM_INTEGER;


