ALTER TABLE COMPANY ADD USE_SHORTFALL_DEDUCT SMALLINT DEFAULT 0;

UPDATE COMPANY SET USE_SHORTFALL_DEDUCT = 0;

ALTER TABLE EMPLOYEE ADD USE_SHORTFALL_SUN SMALLINT DEFAULT 0;

UPDATE EMPLOYEE SET USE_SHORTFALL_SUN = 0;

ALTER TABLE EMPLOYEE ADD SHORTFALL_SUN_HRS INTEGER DEFAULT 0;

UPDATE EMPLOYEE SET SHORTFALL_SUN_HRS = 0;

ALTER TABLE EMPLOYEE ADD SHORTFALL_SUN_MINS INTEGER DEFAULT 0;

UPDATE EMPLOYEE SET SHORTFALL_SUN_MINS = 0;

ALTER TABLE EMPLOYEE_ATTENDANCE_DATA  ADD MINUTES_SHORTFALL_SHORTFALL_NT DM_INTEGER;

ALTER TABLE EMPLOYEE_ATTENDANCE_DATA  ADD MINUTES_SHORTFALL_ABSENT_NT DM_INTEGER;

ALTER TABLE EMPLOYEE_ATTENDANCE_DATA  ADD MINUTES_SHORTFALL_LEAVE_NT DM_INTEGER;

ALTER TABLE EMPLOYEE_ATTENDANCE_DATA  ADD MINUTES_SHORTFALL_SICK_NT DM_INTEGER;

ALTER TABLE EMPLOYEE_ATTENDANCE_DATA  ADD MINUTES_SHORTFALL_SHORTFALL_SUN DM_INTEGER;

ALTER TABLE EMPLOYEE_ATTENDANCE_DATA  ADD MINUTES_SHORTFALL_ABSENT_SUN DM_INTEGER;

ALTER TABLE EMPLOYEE_ATTENDANCE_DATA  ADD MINUTES_SHORTFALL_LEAVE_SUN DM_INTEGER;

ALTER TABLE EMPLOYEE_ATTENDANCE_DATA  ADD MINUTES_SHORTFALL_SICK_SUN DM_INTEGER;

ALTER TABLE EMPLOYEE_ATTENDANCE_AMENDED  ADD MINUTES_SHORTFALL_SHORTFALL_NT DM_INTEGER;

ALTER TABLE EMPLOYEE_ATTENDANCE_AMENDED  ADD MINUTES_SHORTFALL_ABSENT_NT DM_INTEGER;

ALTER TABLE EMPLOYEE_ATTENDANCE_AMENDED  ADD MINUTES_SHORTFALL_LEAVE_NT DM_INTEGER;

ALTER TABLE EMPLOYEE_ATTENDANCE_AMENDED  ADD MINUTES_SHORTFALL_SICK_NT DM_INTEGER;

ALTER TABLE EMPLOYEE_ATTENDANCE_AMENDED  ADD MINUTES_SHORTFALL_SHORTFALL_SUN DM_INTEGER;

ALTER TABLE EMPLOYEE_ATTENDANCE_AMENDED  ADD MINUTES_SHORTFALL_ABSENT_SUN DM_INTEGER;

ALTER TABLE EMPLOYEE_ATTENDANCE_AMENDED  ADD MINUTES_SHORTFALL_LEAVE_SUN DM_INTEGER;

ALTER TABLE EMPLOYEE_ATTENDANCE_AMENDED  ADD MINUTES_SHORTFALL_SICK_SUN DM_INTEGER;

DROP TRIGGER EMPLOYEE_ATTENDANCE_DATA_INSERT;

DROP TRIGGER EMPLOYEE_ATTENDANCE_DATA_UPDATE;

DROP TRIGGER EMPLOYEE_ATTENDANCE_DATA_DELETE;

CREATE TRIGGER EMPLOYEE_ATTENDANCE_DATA_INSERT for EMPLOYEE_ATTENDANCE_DATA
  after insert 
  POSITION 0
as
begin
  INSERT INTO EMPLOYEE_ATTENDANCE_AMENDED 
    SELECT * FROM EMPLOYEE_ATTENDANCE_DATA 
    WHERE EMPLOYEE_ATTENDANCE_DATA_KEY = new.EMPLOYEE_ATTENDANCE_DATA_KEY;
end

CREATE TRIGGER EMPLOYEE_ATTENDANCE_DATA_UPDATE for EMPLOYEE_ATTENDANCE_DATA
  after update 
  POSITION 0
as
begin
  DELETE FROM EMPLOYEE_ATTENDANCE_AMENDED WHERE EMPLOYEE_ATTENDANCE_AMENDED_KEY = new.EMPLOYEE_ATTENDANCE_DATA_KEY;
  INSERT INTO EMPLOYEE_ATTENDANCE_AMENDED SELECT * FROM EMPLOYEE_ATTENDANCE_DATA WHERE EMPLOYEE_ATTENDANCE_DATA_KEY = new.EMPLOYEE_ATTENDANCE_DATA_KEY;
end

CREATE TRIGGER EMPLOYEE_ATTENDANCE_DATA_DELETE for EMPLOYEE_ATTENDANCE_DATA
  after DELETE 
as
begin
  DELETE FROM EMPLOYEE_ATTENDANCE_AMENDED WHERE EMPLOYEE_ATTENDANCE_AMENDED_KEY = old.EMPLOYEE_ATTENDANCE_DATA_KEY;
end
