CREATE GENERATOR PAYROLL_WEEK_DATE_GEN;
COMMIT;

CREATE TABLE PAYROLL_WEEK_DATE (
    PAYROLL_WEEK_DATE_KEY      DM_KEY NOT NULL,
    FINANCIAL_MONTH            DM_SMALLINT,
    FINANCIAL_YEAR             DM_SMALLINT,  
    DATE_WEEK                  DM_DATE,
    DELETED                    DM_BOOLEAN
);

ALTER TABLE PAYROLL_WEEK_DATE ADD PRIMARY KEY (PAYROLL_WEEK_DATE_KEY);

SET TERM ^ ;
CREATE TRIGGER TR_PAYROLL_WEEK_DATE FOR PAYROLL_WEEK_DATE
ACTIVE BEFORE INSERT POSITION 0
AS
begin
  if (new.PAYROLL_WEEK_DATE_KEY is null)
  then begin
         new.PAYROLL_WEEK_DATE_KEY = gen_id(PAYROLL_WEEK_DATE_GEN, 1);
       end
end
^
SET TERM ; ^

COMMIT;


CREATE GENERATOR PAYROLL_FORTNIGHT_DATE_GEN;
COMMIT;

CREATE TABLE PAYROLL_FORTNIGHT_DATE (
    PAYROLL_FORTNIGHT_DATE_KEY   DM_KEY NOT NULL,
    FINANCIAL_MONTH              DM_SMALLINT,
    FINANCIAL_YEAR               DM_SMALLINT,  
    DATE_FORTNIGHT               DM_DATE,
    DELETED                      DM_BOOLEAN
);

ALTER TABLE PAYROLL_FORTNIGHT_DATE ADD PRIMARY KEY (PAYROLL_FORTNIGHT_DATE_KEY);

SET TERM ^ ;
CREATE TRIGGER TR_PAYROLL_FORTNIGHT_DATE FOR PAYROLL_FORTNIGHT_DATE
ACTIVE BEFORE INSERT POSITION 0
AS
begin
  if (new.PAYROLL_FORTNIGHT_DATE_KEY is null)
  then begin
         new.PAYROLL_FORTNIGHT_DATE_KEY = gen_id(PAYROLL_FORTNIGHT_DATE_GEN, 1);
       end
end
^
SET TERM ; ^

COMMIT;


CREATE GENERATOR PAYROLL_MONTH_DATE_GEN;
COMMIT;

CREATE TABLE PAYROLL_MONTH_DATE (
    PAYROLL_MONTH_DATE_KEY       DM_KEY NOT NULL,
    FINANCIAL_MONTH              DM_SMALLINT,
    FINANCIAL_YEAR               DM_SMALLINT,  
    DATE_MONTH                   DM_DATE,
    DELETED                      DM_BOOLEAN
);

ALTER TABLE PAYROLL_MONTH_DATE ADD PRIMARY KEY (PAYROLL_MONTH_DATE_KEY);

SET TERM ^ ;
CREATE TRIGGER TR_PAYROLL_MONTH_DATE FOR PAYROLL_MONTH_DATE
ACTIVE BEFORE INSERT POSITION 0
AS
begin
  if (new.PAYROLL_MONTH_DATE_KEY is null)
  then begin
         new.PAYROLL_MONTH_DATE_KEY = gen_id(PAYROLL_MONTH_DATE_GEN, 1);
       end
end
^
SET TERM ; ^

COMMIT;

CREATE DOMAIN "DM_SHORT_NAME" AS VARCHAR(3);

COMMIT;

alter table MONTH_LIST
add SHORT_MONTH DM_SHORT_NAME;

alter table MONTH_LIST
add MONTH_COLOUR DM_COLOUR_NAME;

COMMIT;

Update MONTH_LIST
Set SHORT_MONTH = 'Jan',
    MONTH_COLOUR = 0
Where MONTH_LIST_KEY = 1;

Update MONTH_LIST
Set SHORT_MONTH = 'Feb',
    MONTH_COLOUR = 0
Where MONTH_LIST_KEY = 2;

Update MONTH_LIST
Set SHORT_MONTH = 'Mar',
    MONTH_COLOUR = 0
Where MONTH_LIST_KEY = 3;

Update MONTH_LIST
Set SHORT_MONTH = 'Apl',
    MONTH_COLOUR = 0
Where MONTH_LIST_KEY = 4;

Update MONTH_LIST
Set SHORT_MONTH = 'May',
    MONTH_COLOUR = 0
Where MONTH_LIST_KEY = 5;

Update MONTH_LIST
Set SHORT_MONTH = 'Jun',
    MONTH_COLOUR = 0
Where MONTH_LIST_KEY = 6;

Update MONTH_LIST
Set SHORT_MONTH = 'Jul',
    MONTH_COLOUR = 0
Where MONTH_LIST_KEY = 7;

Update MONTH_LIST
Set SHORT_MONTH = 'Aug',
    MONTH_COLOUR = 0
Where MONTH_LIST_KEY = 8;

Update MONTH_LIST
Set SHORT_MONTH = 'Sep',
    MONTH_COLOUR = 0
Where MONTH_LIST_KEY = 9;

Update MONTH_LIST
Set SHORT_MONTH = 'Oct',
    MONTH_COLOUR = 0
Where MONTH_LIST_KEY = 10;

Update MONTH_LIST
Set SHORT_MONTH = 'Nov',
    MONTH_COLOUR = 0
Where MONTH_LIST_KEY = 11;

Update MONTH_LIST
Set SHORT_MONTH = 'Dec',
    MONTH_COLOUR = 0
Where MONTH_LIST_KEY = 12;

commit;

ALTER TABLE PAYROLL_WEEK_DATE
ADD DATE_YEAR   DM_SMALLINT;
COMMIT;


ALTER TABLE PAYROLL_FORTNIGHT_DATE
ADD DATE_YEAR   DM_SMALLINT;
COMMIT;


ALTER TABLE PAYROLL_MONTH_DATE
ADD DATE_YEAR   DM_SMALLINT;
COMMIT;


alter table PAYROLL_CALCULATION_CONTROL
add COMPANY_KEY  DM_KEY;
COMMIT;